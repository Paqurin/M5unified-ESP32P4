# ESP32-P4 specific PlatformIO configuration for M5Unified-ESP32P4
# This configuration is optimized for M5Stack Tab5 hardware

[env:m5tab5-esp32p4]
platform = espressif32
board = esp32-p4-function-ev-board
framework = arduino

# ESP32-P4 specific build flags
build_flags =
    -DCONFIG_IDF_TARGET_ESP32P4=1
    -DM5UNIFIED_ESP32P4_ONLY=1
    -DBOARD_HAS_PSRAM=1
    -DARDUINO_M5TAB5=1
    -DCORE_DEBUG_LEVEL=3
    
    # ESP32-P4 Hardware Configuration
    -DPSRAM_SIZE_MB=32
    -DFLASH_SIZE_MB=16
    
    # ESP32-P4 Performance Optimizations
    -O2
    -ffunction-sections
    -fdata-sections
    
    # ESP32-P4 Memory Management
    -DCONFIG_SPIRAM_USE_CAPS_ALLOC=1
    -DCONFIG_SPIRAM_USE_MALLOC=1

build_unflags =
    -DCONFIG_IDF_TARGET_ESP32
    -DCONFIG_IDF_TARGET_ESP32S2
    -DCONFIG_IDF_TARGET_ESP32S3
    -DCONFIG_IDF_TARGET_ESP32C3
    -DCONFIG_IDF_TARGET_ESP32C6

# ESP32-P4 specific library dependencies
lib_deps =
    M5GFX>=0.2.8
    
# ESP32-P4 partitions (adjust as needed for Tab5)
board_build.partitions = default_16MB.csv

# ESP32-P4 Upload settings
upload_speed = 921600
monitor_speed = 115200

# ESP32-P4 specific compiler settings
board_build.f_cpu = 240000000L
board_build.f_flash = 80000000L
board_build.flash_mode = qio

# ESP32-P4 debugging
debug_tool = esp-prog
debug_init_break = tbreak setup